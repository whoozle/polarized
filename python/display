#!/usr/bin/env python

from polarized.palette import Palette, ColorPicker
import png
import argparse

parser = argparse.ArgumentParser(description='Read PNG file and display it in your terminal')
parser.add_argument('input', help='input PNG file')

args = parser.parse_args()
reader = png.Reader(args.input)
w, h, pixels, info = reader.asRGB()
planes = info['planes']

pal = Palette(16)

offset = 0
for row in pixels:
	offset = 0
	for i in xrange(0, w):
		rgb = tuple(row[offset: offset + 3])
		pal.add_color(rgb)
		offset += 3

palette = pal.quantize()
print palette
picker = ColorPicker(palette)
closest = picker.getColor((255, 0, 255))
print closest
